<div
  (mouseenter)="componentHovered()"
  (mouseleave)="componentUnHovered()"
  class="code-block-wrapper col-lg-12 col-md-12 col-xs-12">

  <div class="block-metadata col-xs-12 col-lg-12 col-md-12">
    <div class="block-actions col-lg-12 col-md-12 col-xs-12">
      <div
        [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
        class="block-action col-lg-1 col-md-1 col-xs-1">

        <div class="icon-group">
          <i (click)="remove()" class="icon remove-icon fas fa-trash-alt"></i>
        </div>
      </div>

      <div
        [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
        class="block-action col-lg-1 col-md-1 col-xs-1">

        <i
          (click)="onReadonlyChange()"
          [ngClass]="{'fa-eye': componentState.readonly === false, 'fa-eye-slash': componentState.readonly}"
          class="fas icon readonly-icon"
          [matTooltip]="(componentState.readonly) ? 'Mark as editable' : 'Mark as readonly'">
        </i>
      </div>

      <div
        [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
        class="block-action col-lg-1 col-md-1 col-xs-1">

        <i
          (click)="onGithubGist()"
          class="icon fab fa-github"
          matTooltip="Embed Github gist">
        </i>
      </div>

      <div
        *ngIf="componentState.isGist"
        [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
        class="block-action col-lg-1 col-md-1 col-xs-1">

        <i
          (click)="onRefresh()"
          class="icon fas fa-sync-alt"
          matTooltip="Refresh gist">
        </i>
      </div>

      <div
        *ngIf="componentState.isCode"
        (click)="onSelectEnvironment()"
        [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
        class="block-action col-lg-1 col-md-1 col-xs-1">

        <i
          class="icon fas fa-bug"
          matTooltip="Select environment">
        </i>
      </div>

      <div
        *ngIf="componentState.isCode"
        (click)="onImportCodeProject()"
        [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
        class="block-action col-lg-1 col-md-1 col-xs-1">

        <i
          class="icon fas fa-laptop-code"
          matTooltip="Import code project">
        </i>
      </div>
    </div>
  </div>

  <div class="right-blog-metadata">
    <div
      *ngIf="componentState.codeProjectImported"
      (click)="onRemoveCodeProject()"
      [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
      class="right-block-action">

      <i
        class="icon fas fa-times"
        matTooltip="Remove code project">
      </i>
    </div>

    <div
      *ngIf="componentState.isGist"
      (click)="onClearGist()"
      [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
      class="right-block-action">

      <i
        class="icon fas fa-times"
        matTooltip="Clear gist (back to code)">
      </i>
    </div>

    <div
      *ngIf="componentState.codeProjectImported"
      (click)="onOpenDirectoryStructure()"
      [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
      class="right-block-action">

      <i
        class="icon directory-structure-icon fas fa-folder-open"
        matTooltip="Open directory structure">
      </i>
    </div>

    <div
      *ngIf="componentState.codeProjectImported"
      [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
      class="right-block-action">

      <i
        [routerLink]="'/cms/code-editor/' + componentState.codeProject.shortId"
        class="icon directory-structure-icon fas fa-code"
        matTooltip="Open code editor">
      </i>
    </div>

  </div>

  <div
    class="code-block col-lg-12 col-md-12 col-xs-12 editor-wrapper">

    <ngx-gist *ngIf="componentState.isGist" [gistId]="componentState.gistData.username + '/' + componentState.gistData.gistId"></ngx-gist>

    <ngx-monaco-editor
      *ngIf="componentState.isCode"
      [options]="componentState.editorOptions"
      [(ngModel)]="componentState.code"
      (keyup)="onCodeChange()">
    </ngx-monaco-editor>

    <div
      [style.visibility]="(componentState.hovered) ? 'visible' : 'hidden'"
      *ngIf="componentState.isCode"
      class="test-run-button-wrapper">

      <i *ngIf="componentState.isCodeRunning" class="fas fa-atom fa-spin"></i>

      <button
        [disabled]="componentState.isCodeRunning || !componentState.emulator"
        (click)="onRunCode()"
        class="btn btn-success test-run-button">
        Test run
      </button>
    </div>

    <div
      *ngIf="componentState.emulator && componentState.isCode"
      class="emulator-info-wrapper">

      <p class="text">{{componentState.emulator.text}}<i class="fas fa-bug"></i></p>
    </div>

    <div
      *ngIf="!componentState.emulator && componentState.isCode"
      (click)="onSelectEnvironment()"
      class="emulator-info-wrapper">

      <p class="text missing">Dev environment missing<i class="fas fa-bug"></i></p>
    </div>
  </div>

  <p
    class="saved saved-animation"
    [ngClass]="{'saved-move-up': !this.componentState.saved, 'saved-move-down': this.componentState.saved}">
    Saved</p>

  <cms-block-errors
    *ngIf="componentState.blockErrors"
    [errors]="componentState.blockErrors">
  </cms-block-errors>

  <cms-block-info
    [emulator]="componentState.emulator"
    [readOnly]="componentState.readonly"
    [isGist]="componentState.isGist"
    [isCode]="componentState.isCode"
    [codeProject]="componentState.codeProject">
  </cms-block-info>

  <cms-test-run-result
    *ngIf="componentState.hasTestRunWindow"
    (testRunCloseEvent)="onTestRunWindowClose()"
    [result]="componentState.testRunResult">
  </cms-test-run-result>
</div>
